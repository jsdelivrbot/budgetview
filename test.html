<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <?php
include('config.php');
?>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link rel="icon" type="image/png" href="assets/img/Network.png">


    <!--[if IE]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <![endif]-->
    <title>ระบบประชากร | GISTNU</title>
    <!-- BOOTSTRAP CORE STYLE  -->
    <link href="assets/css/bootstrap.css" rel="stylesheet" />
    <!-- FONT AWESOME ICONS  -->
    <link href="assets/css/font-awesome.css" rel="stylesheet" />
    <!-- CUSTOM STYLE  -->
    <link href="assets/css/style.css" rel="stylesheet" />
    <!-- HTML5 Shiv and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style type="text/css">
        $ {
            demo.css
        }

        .round {
            display: inline-block;
            height: 30px;
            width: 30px;
            line-height: 30px;
            -moz-border-radius: 15px;
            border-radius: 15px;
            background-color: #222;
            color: #FFF;
            text-align: center;
        }

        .round.hollow {
            display: inline-block;
            height: 30px;
            width: 30px;
            line-height: 30px;
            -moz-border-radius: 15px;
            border-radius: 15px;
            background-color: #FFF;
            color: #222;
            text-align: center;
            -webkit-box-shadow: 0px 0px 0px 3px rgba(0, 0, 0, 0.75);
            -moz-box-shadow: 0px 0px 0px 3px rgba(0, 0, 0, 0.75);
            box-shadow: 0px 0px 0px 3px rgba(0, 0, 0, 0.75);
        }

        .round.round-sm {
            height: 20px;
            width: 20px;
            line-height: 20px;
            -moz-border-radius: 10px;
            border-radius: 10px;
            font-size: 0.7em;
        }

        .round.round-lg {
            height: 60px;
            width: 60px;
            line-height: 60px;
            -moz-border-radius: 90px;
            border-radius: 80px;
            font-size: 1.5em;
        }

        .round.blue {
            background-color: #3EA6CE;
        }

        .round.orange {
            background-color: #D7635D;
        }

        .round.green {
            background-color: #42A129;
        }
    </style>

    <script type="text/javascript" src="sel_location.js"></script>

</head>

<body>

    <!-- HEADER END-->
    <div class="navbar navbar-inverse set-radius-zero">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="">

                    <img src="assets/img/logo_gistv1_260px.png" width="90%"/>
                </a>

            </div>

            <div class="left-div">
                <div class="user-settings-wrapper">
                    <ul class="nav">

                        <li class="dropdown">
                        </li>


                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- LOGO HEADER END-->


    <!-- LOGO HEADER END-->
    <section class="menu-section ">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="navbar-collapse collapse ">
                        <ul id="menu-top" class="nav navbar-nav navbar-right">
                            <li><a class="menu-top-active" href="index.php">หน้าแรก</a></li>
                            <li><a href="map.php">แผนที่ประชากร</a></li>
                            <li><a href="chart.php">เปรียบเทียบประชากร</a></li>
                            <li><a href="forms.html">Forms</a></li>
                            <li><a href="login.html">Login Page</a></li>
                            <li><a href="blank.html">Blank Page</a></li>

                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </section>
    <!-- MENU SECTION END-->


    <div class="content-wrapper">
        <div class="container">
            <div class="row">

                <div class="col-md-12">
                    <div class="col-md-6">
                        <iframe src="map_pop1.php" name="my_iframe2" style="width: 100%; height : 690px" frameborder="0"></iframe>
                    </div>

                    <div class="col-md-6">
                        <h4 class="page-head-line">ระบบประชากร</h4>

                        <div class="col-lg-12 col-md-12">
                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <div class="round round-lg orange col-md-2">
                                    <span class="fa fa-users fa-1x"></span>
                                </div>
                                <h5>จำนวนประชากรทั้งหมด</h5>
                                <h4><b>
                                <?php 
                                    $result1 = pg_query("select sum(p_mf_total) as sum_mf from  raw_tam
                                        where year_pop = '2559' ; ");
                                    $arr1 = pg_fetch_array($result1);
                                    $num = number_format($arr1[sum_mf]);
                                    echo $num;
                                 ?>  <small>คน</small>
                                 </b> </h4>
                            </div>

                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <div class="round round-lg orange col-md-2">
                                    <span class="fa fa-thumb-tack fa-1x"></span>
                                </div>
                                <h5>ความหนาแน่นของประชากร</h5>
                                <h4><b><?php 
                                    $result1 = pg_query("select sum(p_mf_total) as sum_mf from  raw_tam
                                        where year_pop = '2559' ; ");
                                    $arr1 = pg_fetch_array($result1);
                                    echo round ($arr1[sum_mf]/ 517611,1);
                                 ?> <small>คน/ตร.กม.</small>  </b> </h4>
                            </div>
                        </div>

                        <div class="col-lg-12 col-md-12"><br>
                        </div>
                        <div class="col-lg-12 col-md-12">
                            <div class="col-lg-6 col-md-3 col-sm-3">
                                <div class="round round-lg orange col-md-2">
                                    <span class="fa fa-male fa-1x"></span>
                                </div>
                                <h5>จำนวนประชากรชาย</h5>
                                <h4><b> <?php 
                                    $result1 = pg_query("select sum(p_m_total) as sum_m from  raw_tam
                                        where year_pop = '2559' ; ");
                                    $arr1 = pg_fetch_array($result1);
                                    $num = number_format($arr1[sum_m]);
                                    echo $num;
                                 ?> <small>คน</small></b> </h4>
                            </div>

                            <div class="col-lg-6 col-md-3 col-sm-3">
                                <div class="round round-lg orange col-md-2">
                                    <span class="fa fa-female fa-1x"></span>
                                </div>
                                <h5>จำนวนประชากรหญิง</h5>
                                <h4><b><?php 
                                    $result1 = pg_query("select sum(p_f_total) as sum_f from  raw_tam
                                        where year_pop = '2559' ; ");
                                    $arr1 = pg_fetch_array($result1);
                                    $num = number_format($arr1[sum_f]);
                                    echo $num;
                                 ?>  <small>คน</small> </b> </h4>
                            </div>
                        </div>
                        <div class="col-md-12"><br>
                        </div>
                        <div class="col-md-12">
                            <div class="col-md-12">
                                <div class="round round-lg orange col-md-2">
                                    <span class="fa fa-line-chart fa-1x"></span>
                                </div>
                                <h5>อัตราการเปลี่ยนแปลงของประชากรจากปีที่แล้ว</h5>
                                <h4><b><?php 
                                    $result1 = pg_query("select year_pop,sum(p_mf_total)
                                    from raw_tam 
                                    where year_pop = 2559
                                    group by year_pop ; ");
                                    $result2 = pg_query("select year_pop,sum(p_mf_total)
                                    from raw_tam 
                                    where year_pop = 2558
                                    group by year_pop ; ");
                                    $arr1 = pg_fetch_array($result1);
                                    $arr2 = pg_fetch_array($result2);
                                    echo round(($arr1[sum]-$arr2[sum] )*100/$arr2[sum] , 2) ;
                                 ?> % </b> </h4>
                            </div>
                        </div>

                        <div class="col-md-12"><br>
                        </div>

                        <div id="mainb" style="height:350px;width:100%"></div>



                    </div>
                </div>
                
                <div class="col-md-6">
                    <table class="table table-striped table-hover ">
                      <thead>
                        <tr>
                          <th width="50%">รายชื่อจังหวัด</th>
                          <th>ปี 2540</th>
                          <th>ปี 2560</th>
                          <th width="10%"></th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>พิษณุโลก</th>
                          <td>1542665</td>
                          <td>1542665</td>
                          <td> <td data-sparkline="40, 11, 63, 51 "/></td>
                        </tr>
                        <tr>
                          <th>สุโขทัย</th>
                          <td>1542665</td>
                          <td>1542665</td>
                          <td> <td data-sparkline="40, 11, 63, 51 "/></td>
                        </tr>
                        <tr>
                          <th>พิจิตร</th>
                          <td>1542665</td>
                          <td>1542665</td>
                          <td> <td data-sparkline="40, 11, 63, 51 "/></td>
                        </tr>
                        <tr>
                          <th>พิจิตร</th>
                          <td>1542665</td>
                          <td>1542665</td>
                          <td> <td data-sparkline="40, 11, 63, 51 "/></td>
                        </tr>
                        <tr>
                          <th>พิจิตร</th>
                          <td>1542665</td>
                          <td>1542665</td>
                          <td> <td data-sparkline="40, 11, 63, 51 "/></td>
                        </tr>
                        <tr>
                          <th>พิจิตร</th>
                          <td>1542665</td>
                          <td>1542665</td>
                          <td> <td data-sparkline="40, 11, 63, 51 "/></td>
                        </tr>
                        <tr>
                          <th>พิจิตร</th>
                          <td>1542665</td>
                          <td>1542665</td>
                          <td> <td data-sparkline="40, 11, 63, 51 "/></td>
                        </tr>
                        <tr>
                          <th>พิจิตร</th>
                          <td>1542665</td>
                          <td>1542665</td>
                          <td> <td data-sparkline="40, 11, 63, 51 "/></td>
                        </tr>
                        <tr>
                          <th>พิจิตร</th>
                          <td>1542665</td>
                          <td>1542665</td>
                          <td> <td data-sparkline="40, 11, 63, 51 "/></td>
                        </tr>
                        <tr>
                          <th>พิจิตร</th>
                          <td>1542665</td>
                          <td>1542665</td>
                          <td> <td data-sparkline="40, 11, 63, 51 "/></td>
                        </tr>
                      </tbody>
                    </table>
                </div>

                <div class="col-md-6">
                      <div id="container" style="min-width: 310px; max-width: 800px; height: 460px; margin: 0 auto"></div>
                </div>


            </div>







        </div>
        <!-- MENU SECTION END-->


    </div>


    <!-- CONTENT-WRAPPER SECTION END-->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    Regional Center of Geo-Informatics and Space Technology, Lower Northern Region, Naresuan University
                </div>

            </div>
        </div>
    </footer>
    <!-- FOOTER SECTION END-->
    <!-- JAVASCRIPT AT THE BOTTOM TO REDUCE THE LOADING TIME  -->
    <!-- CORE JQUERY SCRIPTS -->
    <script src="assets/js/jquery-1.11.1.js"></script>
    <!-- BOOTSTRAP SCRIPTS  -->
    <script src="assets/js/bootstrap.js"></script>


    <!-- jQuery -->
    <script src="vendors/jquery/dist/jquery.min.js"></script>
    <!-- ECharts -->
    <script src="vendors/echarts/dist/echarts.min.js"></script>
        
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>




    <script>
        var theme = {
            color: [
                '#c36464', '#996666', '#BDC3C7', '#3498DB',
                '#9B59B6', '#8abb6f', '#759c6a', '#bfd3b7'
            ],

            title: {
                itemGap: 8,
                textStyle: {
                    fontWeight: 'normal',
                    color: '#408829'
                }
            },

            dataRange: {
                color: ['#1f610a', '#97b58d']
            },

            toolbox: {
                color: ['#408829', '#408829', '#408829', '#408829']
            },

            tooltip: {
                backgroundColor: 'rgba(0,0,0,0.5)',
                axisPointer: {
                    type: 'line',
                    lineStyle: {
                        color: '#408829',
                        type: 'dashed'
                    },
                    crossStyle: {
                        color: '#408829'
                    },
                    shadowStyle: {
                        color: 'rgba(200,200,200,0.3)'
                    }
                }
            },

            dataZoom: {
                dataBackgroundColor: '#eee',
                fillerColor: 'rgba(64,136,41,0.2)',
                handleColor: '#408829'
            },
            grid: {
                borderWidth: 0
            },

            categoryAxis: {
                axisLine: {
                    lineStyle: {
                        color: '#408829'
                    }
                },
                splitLine: {
                    lineStyle: {
                        color: ['#eee']
                    }
                }
            },

            valueAxis: {
                axisLine: {
                    lineStyle: {
                        color: '#408829'
                    }
                },
                splitArea: {
                    show: true,
                    areaStyle: {
                        color: ['rgba(250,250,250,0.1)', 'rgba(200,200,200,0.1)']
                    }
                },
                splitLine: {
                    lineStyle: {
                        color: ['#eee']
                    }
                }
            },
            timeline: {
                lineStyle: {
                    color: '#408829'
                },
                controlStyle: {
                    normal: {
                        color: '#408829'
                    },
                    emphasis: {
                        color: '#408829'
                    }
                }
            },

            k: {
                itemStyle: {
                    normal: {
                        color: '#68a54a',
                        color0: '#a9cba2',
                        lineStyle: {
                            width: 1,
                            color: '#408829',
                            color0: '#86b379'
                        }
                    }
                }
            },
            map: {
                itemStyle: {
                    normal: {
                        areaStyle: {
                            color: '#ddd'
                        },
                        label: {
                            textStyle: {
                                color: '#c12e34'
                            }
                        }
                    },
                    emphasis: {
                        areaStyle: {
                            color: '#99d2dd'
                        },
                        label: {
                            textStyle: {
                                color: '#c12e34'
                            }
                        }
                    }
                }
            },
            force: {
                itemStyle: {
                    normal: {
                        linkStyle: {
                            strokeColor: '#408829'
                        }
                    }
                }
            },
            chord: {
                padding: 4,
                itemStyle: {
                    normal: {
                        lineStyle: {
                            width: 1,
                            color: 'rgba(128, 128, 128, 0.5)'
                        },
                        chordStyle: {
                            lineStyle: {
                                width: 1,
                                color: 'rgba(128, 128, 128, 0.5)'
                            }
                        }
                    },
                    emphasis: {
                        lineStyle: {
                            width: 1,
                            color: 'rgba(128, 128, 128, 0.5)'
                        },
                        chordStyle: {
                            lineStyle: {
                                width: 1,
                                color: 'rgba(128, 128, 128, 0.5)'
                            }
                        }
                    }
                }
            },
            gauge: {
                startAngle: 225,
                endAngle: -45,
                axisLine: {
                    show: true,
                    lineStyle: {
                        color: [
                            [0.2, '#86b379'],
                            [0.8, '#68a54a'],
                            [1, '#408829']
                        ],
                        width: 8
                    }
                },
                axisTick: {
                    splitNumber: 10,
                    length: 12,
                    lineStyle: {
                        color: 'auto'
                    }
                },
                axisLabel: {
                    textStyle: {
                        color: 'auto'
                    }
                },
                splitLine: {
                    length: 18,
                    lineStyle: {
                        color: 'auto'
                    }
                },
                pointer: {
                    length: '90%',
                    color: 'auto'
                },
                title: {
                    textStyle: {
                        color: '#333'
                    }
                },
                detail: {
                    textStyle: {
                        color: 'auto'
                    }
                }
            },
            textStyle: {
                fontFamily: 'Arial, Verdana, sans-serif'
            }
        };




        var echartBar = echarts.init(document.getElementById('mainb'), theme);

        echartBar.setOption({
            title: {
                text: '',
                subtext: ''
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['สถิติประชากรรายปี']
            },
            toolbox: {
                show: false,
                feature: {
                    magicType: {
                        show: true,
                        title: {
                            bar: 'Line'
                        },
                        type: ['line']
                    },
                    restore: {
                        show: true,
                        title: "Restore"
                    },
                    saveAsImage: {
                        show: true,
                        title: "Save Image"
                    }
                }
            },
            calculable: false,
            xAxis: [{
                type: 'category',
                data: [
                                <?php 
                                    $result2 = pg_query("select year_pop,sum(p_mf_total)
                                    from raw_tam 
                                    group by year_pop
                                    order by year_pop asc; ");
                                   while ($arr2 = pg_fetch_array($result2)) {
                                 ?>            
                '<?php echo $arr2[year_pop]; ?>',
<?php } ?>
                 ]
            }],
            yAxis: [{
                type: 'value'
            }],
            series: [{
                name: 'สถิติประชากรรายปี',
                type: 'line',
                data: [   <?php 
                                    $result2 = pg_query("select year_pop,sum(p_mf_total)
                                    from raw_tam 
                                    group by year_pop
                                    order by year_pop asc; ");
                                   while ($arr2 = pg_fetch_array($result2)) {
                                 ?>            
                '<?php echo $arr2[sum]; ?>',
<?php } ?>],
                markPoint: {
                    data: [{
                        type: 'max',
                        name: 'มากที่สุด'
                    }, {
                        type: 'min',
                        name: 'น้อยที่สุด'
                    }]
                },
                markLine: {
                    data: [{
                        type: 'average',
                        name: 'เฉลี่ย'
                    }]
                }
            }]
        });




        var dataStyle = {
            normal: {
                label: {
                    show: false
                },
                labelLine: {
                    show: false
                }
            }
        };

        var placeHolderStyle = {
            normal: {
                color: 'rgba(0,0,0,0)',
                label: {
                    show: false
                },
                labelLine: {
                    show: false
                }
            },
            emphasis: {
                color: 'rgba(0,0,0,0)'
            }
        };
    </script>





<script type="text/javascript">

$(function () {
    /**
     * Create a constructor for sparklines that takes some sensible defaults and merges in the individual
     * chart options. This function is also available from the jQuery plugin as $(element).highcharts('SparkLine').
     */
    Highcharts.SparkLine = function (a, b, c) {
        var hasRenderToArg = typeof a === 'string' || a.nodeName,
            options = arguments[hasRenderToArg ? 1 : 0],
            defaultOptions = {
                chart: {
                    renderTo: (options.chart && options.chart.renderTo) || this,
                    backgroundColor: null,
                    borderWidth: 0,
                    type: 'area',
                    margin: [2, 0, 2, 0],
                    width: 120,
                    height: 20,
                    style: {
                        overflow: 'visible'
                    },
                    skipClone: true
                },
                title: {
                    text: ''
                },
                credits: {
                    enabled: false
                },
                xAxis: {
                    labels: {
                        enabled: false
                    },
                    title: {
                        text: null
                    },
                    startOnTick: false,
                    endOnTick: false,
                    tickPositions: []
                },
                yAxis: {
                    endOnTick: false,
                    startOnTick: false,
                    labels: {
                        enabled: false
                    },
                    title: {
                        text: null
                    },
                    tickPositions: [0]
                },
                legend: {
                    enabled: false
                },
                tooltip: {
                    backgroundColor: null,
                    borderWidth: 0,
                    shadow: false,
                    useHTML: true,
                    hideDelay: 0,
                    shared: true,
                    padding: 0,
                    positioner: function (w, h, point) {
                        return { x: point.plotX - w / 2, y: point.plotY - h };
                    }
                },
                plotOptions: {
                    series: {
                        animation: false,
                        lineWidth: 1,
                        shadow: false,
                        states: {
                            hover: {
                                lineWidth: 1
                            }
                        },
                        marker: {
                            radius: 1,
                            states: {
                                hover: {
                                    radius: 2
                                }
                            }
                        },
                        fillOpacity: 0.25
                    },
                    column: {
                        negativeColor: '#910000',
                        borderColor: 'silver'
                    }
                }
            };

        options = Highcharts.merge(defaultOptions, options);

        return hasRenderToArg ?
            new Highcharts.Chart(a, options, c) :
            new Highcharts.Chart(options, b);
    };

    var start = +new Date(),
        $tds = $('td[data-sparkline]'),
        fullLen = $tds.length,
        n = 0;

    // Creating 153 sparkline charts is quite fast in modern browsers, but IE8 and mobile
    // can take some seconds, so we split the input into chunks and apply them in timeouts
    // in order avoid locking up the browser process and allow interaction.
    function doChunk() {
        var time = +new Date(),
            i,
            len = $tds.length,
            $td,
            stringdata,
            arr,
            data,
            chart;

        for (i = 0; i < len; i += 1) {
            $td = $($tds[i]);
            stringdata = $td.data('sparkline');
            arr = stringdata.split('; ');
            data = $.map(arr[0].split(', '), parseFloat);
            chart = {};

            if (arr[1]) {
                chart.type = arr[1];
            }
            $td.highcharts('SparkLine', {
                series: [{
                    data: data,
                    pointStart: 1
                }],
                tooltip: {
                    headerFormat: '<span style="font-size: 10px">' + $td.parent().find('th').html() ,
                    pointFormat: '<b> {point.y} </b> คน'
                },
                chart: chart
            });

            n += 1;

            // If the process takes too much time, run a timeout to allow interaction with the browser
            if (new Date() - time > 500) {
                $tds.splice(0, i + 1);
                setTimeout(doChunk, 0);
                break;
            }

            // Print a feedback on the performance
            if (n === fullLen) {
                $('#result').html('Generated ' + fullLen + ' sparklines in ' + (new Date() - start) + ' ms');
            }
        }
    }
    doChunk();

});
        </script>


<script>// Data gathered from http://populationpyramid.net/germany/2015/

// Age categories
var categories = ['0-4', '5-9', '10-14', '15-19',
        '20-24', '25-29', '30-34', '35-39', '40-44',
        '45-49', '50-54', '55-59', '60-64', '65-69',
        '70-74', '75-79', '80-84', '85-89', '90-94',
        '95-99', '100 + '];
$(document).ready(function () {
    Highcharts.chart('container', {
        chart: {
            type: 'bar'
        },
        title: {
            text: 'Population pyramid for Germany, 2015'
        },
        subtitle: {
            text: 'Source: <a href="http://populationpyramid.net/germany/2015/">Population Pyramids of the World from 1950 to 2100</a>'
        },
        xAxis: [{
            categories: categories,
            reversed: false,
            labels: {
                step: 1
            }
        }, { // mirror axis on right side
            opposite: true,
            reversed: false,
            categories: categories,
            linkedTo: 0,
            labels: {
                step: 1
            }
        }],
        yAxis: {
            title: {
                text: null
            },
            labels: {
                formatter: function () {
                    return Math.abs(this.value) + '%';
                }
            }
        },

        plotOptions: {
            series: {
                stacking: 'normal'
            }
        },

        tooltip: {
            formatter: function () {
                return '<b>' + this.series.name + ', age ' + this.point.category + '</b><br/>' +
                    'Population: ' + Highcharts.numberFormat(Math.abs(this.point.y), 0);
            }
        },

        series: [{
            name: 'Male',
            data: [-2.2, -2.2, -2.3, -2.5, -2.7, -3.1, -3.2,
                -3.0, -3.2, -4.3, -4.4, -3.6, -3.1, -2.4,
                -2.5, -2.3, -1.2, -0.6, -0.2, -0.0, -0.0]
        }, {
            name: 'Female',
            data: [2.1, 2.0, 2.2, 2.4, 2.6, 3.0, 3.1, 2.9,
                3.1, 4.1, 4.3, 3.6, 3.4, 2.6, 2.9, 2.9,
                1.8, 1.2, 0.6, 0.1, 0.0]
        }]
    });
});
</script>

</body>

</html>